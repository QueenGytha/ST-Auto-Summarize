/**
 * Flowtype definitions for sillytavern
 * Generated by Flowgen from a Typescript Definition
 * Flowgen v1.21.0
 */

declare module "../../../../script.js" {
  /**
   * CRITICAL: This is a BOOLEAN VARIABLE, not a function!
   * Indicates whether a message send/generation is currently in progress.
   * Use setSendButtonState(value) to modify this.
   * @example // CORRECT:
   * if (is_send_press) { ... }
   *
   * // WRONG - will cause TypeError:
   * is_send_press(true);
   */
  declare export var is_send_press: boolean;

  /**
   * Animation duration in milliseconds
   */
  declare export var animation_duration: number;

  /**
   * Animation easing function name
   */
  declare export var animation_easing: string;

  /**
   * Default max length of AI generated responses
   */
  declare export var amount_gen: number;

  /**
   * Maximum context size in tokens
   */
  declare export var max_context: number;

  /**
   * Current main API being used (e.g., 'openai', 'kobold', 'novel')
   */
  declare export var main_api: string;

  /**
   * Current menu type
   */
  declare export var menu_type: string;

  /**
   * Current user name
   */
  declare export var name1: string;

  /**
   * Current character/AI name
   */
  declare export var name2: string;

  /**
   * Current online connection status
   */
  declare export var online_status: string;

  /**
   * Current character ID
   */
  declare export var this_chid: number | void;

  /**
   * Current chat messages array
   */
  declare export var chat: any[];

  /**
   * Chat metadata object
   */
  declare export var chat_metadata: { [key: string]: any, ... };

  /**
   * Streaming processor instance
   */
  declare export var streamingProcessor: any;

  /**
   * Array of all loaded characters
   */
  declare export var characters: any[];

  /**
   * Extension prompts registry
   */
  declare export var extension_prompts: { [key: string]: any, ... };

  /**
   * Whether chat is currently being saved
   */
  declare export var isChatSaving: boolean;

  /**
   * SillyTavern display version string
   */
  declare export var displayVersion: string;

  /**
   * Active character identifier
   */
  declare export var active_character: string;

  /**
   * Active group identifier
   */
  declare export var active_group: string;

  /**
   * Settings object
   */
  declare export var settings: any;

  /**
   * Authentication token
   */
  declare export var token: string | void;

  /**
   * Default animation duration
   */
  declare export var ANIMATION_DURATION_DEFAULT: number;

  /**
   * System user name constant
   */
  declare export var systemUserName: string;

  /**
   * Neutral character name constant
   */
  declare export var neutralCharacterName: string;

  /**
   * Default user avatar path
   */
  declare export var default_user_avatar: string;

  /**
   * Default AI avatar path
   */
  declare export var default_avatar: string;

  /**
   * System avatar path
   */
  declare export var system_avatar: string;

  /**
   * Comment avatar path
   */
  declare export var comment_avatar: string;

  /**
   * Maximum injection depth for extension prompts
   */
  declare export var MAX_INJECTION_DEPTH: number;

  /**
   * Default talkativeness value
   */
  declare export var talkativeness_default: number;

  /**
   * Default depth prompt depth
   */
  declare export var depth_prompt_depth_default: number;

  /**
   * Default depth prompt role
   */
  declare export var depth_prompt_role_default: string;

  /**
   * Main chat element jQuery reference
   */
  declare export var chatElement: any;

  /**
   * Character drag-drop handler
   */
  declare export var charDragDropHandler: any;

  /**
   * Chat drag-drop handler
   */
  declare export var chatDragDropHandler: any;

  /**
   * Default save/edit timeout constant
   */
  declare export var DEFAULT_SAVE_EDIT_TIMEOUT: number;

  /**
   * Default print timeout constant
   */
  declare export var DEFAULT_PRINT_TIMEOUT: number;

  /**
   * Character creation/save data object
   */
  declare export var create_save: any;

  /**
   * Extension prompt types enum
   * @example { BEFORE_PROMPT: 0, IN_PROMPT: 1, AFTER_PROMPT: 2, ... }
   */
  declare export var extension_prompt_types: {
    BEFORE_PROMPT: number,
    IN_PROMPT: number,
    AFTER_PROMPT: number,
    [key: string]: number,
  };

  /**
   * Extension prompt roles enum
   * @example { SYSTEM: 0, USER: 1, ASSISTANT: 2 }
   */
  declare export var extension_prompt_roles: {
    SYSTEM: number,
    USER: number,
    ASSISTANT: number,
    [key: string]: number,
  };

  /**
   * System message types (imported from system-messages.js)
   */
  declare export var system_message_types: {
    GENERIC: string,
    NARRATOR: string,
    ASSISTANT_NOTE: string,
    [key: string]: string,
  };

  /**
   * API connection map for slash commands
   */
  declare export var CONNECT_API_MAP: { [key: string]: any, ... };

  /**
   * Sets the send button state (locks/unlocks UI during generation)
   * @param value - true to lock (generation in progress), false to unlock
   */
  declare export function setSendButtonState(value: boolean): void;

  /**
   * Activates (enables) send buttons
   */
  declare export function activateSendButtons(): void;

  /**
   * Deactivates (disables) send buttons
   */
  declare export function deactivateSendButtons(): void;

  /**
   * Generates text using raw API call
   * @param options - Generation options
   * @returns Generated text
   */
  declare export function generateRaw(options: {
    prompt?: string,
    api?: string | null,
    instructOverride?: boolean,
    quietToLoud?: boolean,
    systemPrompt?: string,
    responseLength?: number | null,
    trimNames?: boolean,
    prefill?: string,
    jsonSchema?: any,
    ...
  }): Promise<string>;

  /**
   * Gets the maximum context size for current API/model
   * @param overrideResponseLength - Optional response length override
   * @returns Maximum context size in tokens
   */
  declare export function getMaxContextSize(
    overrideResponseLength?: number | null
  ): number;

  /**
   * Scrolls chat to bottom
   */
  declare export function scrollChatToBottom(): void;

  /**
   * Saves settings with debounce
   */
  declare export function saveSettingsDebounced(): void;

  /**
   * Saves character with debounce
   */
  declare export function saveCharacterDebounced(): void;

  /**
   * Saves chat with debounce
   */
  declare export function saveChatDebounced(): void;

  /**
   * Saves metadata for current chat or group
   * If in a group chat, saves group metadata. Otherwise saves chat metadata.
   * @returns Promise that resolves when save completes
   */
  declare export function saveMetadata(): Promise<void>;

  /**
   * Gets current chat ID
   * @returns Current chat ID or undefined
   */
  declare export function getCurrentChatId(): string | void;

  /**
   * Gets request headers for API calls
   * @param options - Header options
   * @returns Headers object
   */
  declare export function getRequestHeaders(options?: {
    omitContentType?: boolean,
    ...
  }): { [key: string]: string, ... };

  /**
   * Substitutes template params in content
   * @param content - Content with template variables
   * @param _name1 - User name (optional)
   * @param _name2 - Character name (optional)
   * @param _original - Original content (optional)
   * @param _group - Group info (optional)
   * @param _replaceCharacterCard - Whether to replace character card (optional)
   * @param additionalMacro - Additional macro definitions (optional)
   * @param postProcessFn - Post-processing function (optional)
   * @returns Content with substituted params
   */
  declare export function substituteParams(
    content: string,
    _name1?: string,
    _name2?: string,
    _original?: string,
    _group?: any,
    _replaceCharacterCard?: boolean,
    additionalMacro?: { [key: string]: any, ... },
    postProcessFn?: (x: string) => string
  ): string;

  /**
   * Extended version of substituteParams with additional macro support
   * @param content - Content with template variables
   * @param additionalMacro - Additional macro definitions
   * @param postProcessFn - Post-processing function
   * @returns Content with substituted params
   */
  declare export function substituteParamsExtended(
    content: string,
    additionalMacro?: { [key: string]: any, ... },
    postProcessFn?: (x: string) => string
  ): string;

  /**
   * Formats a message for display
   * @param mes - Message text
   * @param ch_name - Character name
   * @param isSystem - Whether message is system message
   * @param isUser - Whether message is user message
   * @param messageId - Message ID
   * @param sanitizerOverrides - Sanitizer override options
   * @param isReasoning - Whether message is reasoning
   * @returns Formatted message HTML
   */
  declare export function messageFormatting(
    mes: string,
    ch_name: string,
    isSystem: boolean,
    isUser: boolean,
    messageId: number,
    sanitizerOverrides?: { [key: string]: any, ... },
    isReasoning?: boolean
  ): string;

  /**
   * Updates a message block in the UI
   * @param messageId - Message ID to update
   * @param message - New message object
   * @param options - Update options
   */
  declare export function updateMessageBlock(
    messageId: number,
    message: any,
    options?: {
      rerenderMessage?: boolean,
      ...
    }
  ): void;

  /**
   * Adds one message to the chat
   * @param mes - Message object
   * @param options - Display options
   */
  declare export function addOneMessage(
    mes: any,
    options?: {
      type?: string,
      insertAfter?: number | null,
      scroll?: boolean,
      insertBefore?: number | null,
      forceId?: number | null,
      showSwipes?: boolean,
      ...
    }
  ): void;

  /**
   * Appends media (images, audio) to a message element
   * @param mes - Message object
   * @param messageElement - Message DOM element
   * @param adjustScroll - Whether to adjust scroll position
   */
  declare export function appendMediaToMessage(
    mes: any,
    messageElement: any,
    adjustScroll?: boolean
  ): void;

  /**
   * Sets an extension prompt at specified position/depth
   * @param key - Prompt identifier key
   * @param value - Prompt text
   * @param position - Position in prompt (from extension_prompt_types)
   * @param depth - Injection depth
   * @param scan - Whether to scan for activation
   * @param role - Prompt role (from extension_prompt_roles)
   * @param filter - Optional filter function
   */
  declare export function setExtensionPrompt(
    key: string,
    value: string,
    position: number,
    depth: number,
    scan?: boolean,
    role?: number,
    filter?: ((messages: any[]) => any[]) | null
  ): void;

  /**
   * Updates chat metadata
   * @param newValues - New metadata values
   * @param reset - Whether to reset existing metadata
   */
  declare export function updateChatMetadata(
    newValues: { [key: string]: any, ... },
    reset?: boolean
  ): void;

  /**
   * Displays a popup dialog
   * @param text - Popup text/HTML
   * @param type - Popup type
   * @param inputValue - Default input value
   * @param options - Popup options
   * @returns Promise that resolves with user input
   */
  declare export function callPopup(
    text: string,
    type: string,
    inputValue?: string,
    options?: {
      okButton?: string,
      rows?: number,
      wide?: boolean,
      wider?: boolean,
      large?: boolean,
      allowHorizontalScrolling?: boolean,
      allowVerticalScrolling?: boolean,
      cropAspect?: number,
      ...
    }
  ): Promise<string | boolean | null>;

  /**
   * Stops current generation
   */
  declare export function stopGeneration(): void;

  /**
   * Resets chat state
   */
  declare export function resetChatState(): void;

  /**
   * Sets menu type
   * @param value - Menu type string
   */
  declare export function setMenuType(value: string): void;

  /**
   * Sets character ID
   * @param value - Character ID
   */
  declare export function setCharacterId(value: number | void): void;

  /**
   * Sets character name
   * @param value - Character name
   */
  declare export function setCharacterName(value: string): void;

  /**
   * Sets online status
   * @param value - Online status string
   */
  declare export function setOnlineStatus(value: string): void;

  /**
   * Sets edited message ID
   * @param value - Message ID
   */
  declare export function setEditedMessageId(value: number): void;

  /**
   * Gets thumbnail URL for media
   * @param type - Media type
   * @param file - File path
   * @param t - Timestamp flag
   * @returns Thumbnail URL
   */
  declare export function getThumbnailUrl(
    type: string,
    file: string,
    t?: boolean
  ): string;

  /**
   * Swipe left (previous message variant)
   * @param _event - Event object
   * @param options - Swipe options
   */
  declare export function swipe_left(
    _event?: any,
    options?: {
      source?: string,
      repeated?: boolean,
      ...
    }
  ): void;

  /**
   * Swipe right (next message variant)
   * @param _event - Event object
   * @param options - Swipe options
   */
  declare export function swipe_right(
    _event?: any | null,
    options?: {
      source?: string,
      repeated?: boolean,
      ...
    }
  ): void;

  /**
   * Gets character card fields
   * @param options - Options object
   * @returns Character card fields
   */
  declare export function getCharacterCardFields(options?: {
    chid?: number | null,
    ...
  }): { [key: string]: any, ... };

  /**
   * Reloads markdown processor
   */
  declare export function reloadMarkdownProcessor(): void;
}

declare module "../../../../scripts/st-context.js" {

  /**
   * Context object returned by getContext()
   * Provides access to SillyTavern's internal state and functions
   */
  declare export interface STContext {
    accountStorage: any;
    chat: any[];
    characters: any[];
    groups: any[];
    name1: string;
    name2: string;
    characterId: number | void;
    groupId: string;
    chatId: string | void;
    getCurrentChatId: () => string | void;
    getRequestHeaders: (options?: {
      omitContentType?: boolean,
      ...
    }) => { [key: string]: string, ... };
    reloadCurrentChat: () => Promise<void>;
    renameChat: (newName: string) => Promise<void>;
    saveSettingsDebounced: () => void;
    onlineStatus: string;
    maxContext: number;
    chatMetadata: { [key: string]: any, ... };
    saveMetadataDebounced: () => void;
    streamingProcessor: any;
    eventSource: any;
    eventTypes: any;
    event_types: any;
    addOneMessage: (mes: any, options?: any) => void;
    deleteLastMessage: () => void;
    generate: any;
    sendStreamingRequest: any;
    sendGenerationRequest: any;
    stopGeneration: () => void;
    tokenizers: any;
    getTextTokens: (text: string) => any[];
    getTokenCount: (text: string) => number;
    getTokenCountAsync: (text: string) => Promise<number>;
    extensionPrompts: { [key: string]: any, ... };
    setExtensionPrompt: (
      key: string,
      value: string,
      position: number,
      depth: number,
      scan?: boolean,
      role?: number,
      filter?: any
    ) => void;
    updateChatMetadata: (
      newValues: { [key: string]: any, ... },
      reset?: boolean
    ) => void;
    saveChat: (force?: boolean) => Promise<void>;
    openCharacterChat: (characterId: number) => Promise<void>;
    openGroupChat: (groupId: string) => Promise<void>;
    saveMetadata: () => void;
    sendSystemMessage: (type: string, text?: string, options?: any) => void;
    activateSendButtons: () => void;
    deactivateSendButtons: () => void;
    saveReply: (type: string, mes: string) => Promise<void>;
    substituteParams: (content: string, ...args: any[]) => string;
    substituteParamsExtended: (
      content: string,
      additionalMacro?: { [key: string]: any, ... },
      postProcessFn?: (x: string) => string
    ) => string;
    SlashCommandParser: any;
    SlashCommand: any;
    SlashCommandArgument: any;
    SlashCommandNamedArgument: any;
    ARGUMENT_TYPE: any;
    executeSlashCommandsWithOptions: any;
    registerSlashCommand: any;
    executeSlashCommands: any;
    timestampToMoment: (timestamp: number) => any;
    registerHelper: () => void;
    registerMacro: (name: string, fn: Function) => void;
    unregisterMacro: (name: string) => void;
    registerFunctionTool: any;
    unregisterFunctionTool: any;
    isToolCallingSupported: any;
    canPerformToolCalls: any;
    ToolManager: any;
    registerDebugFunction: (name: string, fn: Function) => void;
    renderExtensionTemplate: any;
    renderExtensionTemplateAsync: (
      extensionName: string,
      templateName: string,
      data?: any
    ) => Promise<string>;
    registerDataBankScraper: any;
    callPopup: (
      text: string,
      type: string,
      inputValue?: string,
      options?: any
    ) => Promise<any>;
    callGenericPopup: any;
    showLoader: () => void;
    hideLoader: () => void;
    mainApi: string;
    extensionSettings: { [key: string]: any, ... };
    ModuleWorkerWrapper: any;
    getTokenizerModel: () => string;
    generateQuietPrompt: any;
    generateRaw: (options: any) => Promise<string>;
    writeExtensionField: (
      extensionName: string,
      key: string,
      value: any
    ) => Promise<void>;
    getThumbnailUrl: (type: string, file: string, t?: boolean) => string;
    selectCharacterById: (characterId: number) => Promise<void>;
    messageFormatting: (
      mes: string,
      ch_name: string,
      isSystem: boolean,
      isUser: boolean,
      messageId: number,
      sanitizerOverrides?: any,
      isReasoning?: boolean
    ) => string;
    shouldSendOnEnter: () => boolean;
    isMobile: () => boolean;
    t: (key: string, ...args: any[]) => string;
    translate: (
      text: string,
      lang: string,
      provider?: string | null
    ) => Promise<string>;
    getCurrentLocale: () => string;
    addLocaleData: (
      locale: string,
      data: { [key: string]: string, ... }
    ) => void;
    tags: any[];
    tagMap: Map<any, any>;
    menuType: string;
    createCharacterData: any;
    Popup: any;
    POPUP_TYPE: any;
    POPUP_RESULT: any;
    chatCompletionSettings: any;
    textCompletionSettings: any;
    powerUserSettings: any;
    getCharacters: () => any[];
    getCharacterCardFields: (options?: {
      chid?: number | null,
      ...
    }) => { [key: string]: any, ... };
    uuidv4: () => string;
    humanizedDateTime: (timestamp: number) => string;
    updateMessageBlock: (
      messageId: number,
      message: any,
      options?: any
    ) => void;
    appendMediaToMessage: (
      mes: any,
      messageElement: any,
      adjustScroll?: boolean
    ) => void;
    swipe: {
      left: (event?: any, options?: any) => void,
      right: (event?: any | null, options?: any) => void,
      ...
    };
    variables: {
      local: {
        get: (name: string) => any,
        set: (name: string, value: any) => void,
        ...
      },
      global: {
        get: (name: string) => any,
        set: (name: string, value: any) => void,
        ...
      },
      ...
    };
    loadWorldInfo: any;
    saveWorldInfo: any;
    reloadWorldInfoEditor: any;
    updateWorldInfoList: any;
    convertCharacterBook: any;
    getWorldInfoPrompt: any;
    CONNECT_API_MAP: { [key: string]: any, ... };
    getTextGenServer: any;
    extractMessageFromData: any;
    getPresetManager: any;
    getChatCompletionModel: any;
    printMessages: any;
    clearChat: any;
    ChatCompletionService: any;
    TextCompletionService: any;
    ConnectionManagerRequestService: any;
    updateReasoningUI: any;
    parseReasoningFromString: any;
    unshallowCharacter: any;
    unshallowGroupMembers: any;
    openThirdPartyExtensionMenu: any;
    symbols: {
      ignore: Symbol,
      ...
    };
    set_connection_profile?: (profile: string) => Promise<void>;
    set_preset?: (preset: string) => Promise<void>;
    get_current_connection_profile?: () => Promise<string>;
    get_current_preset?: () => Promise<string>;
  }

  /**
   * Gets the SillyTavern context object
   * @returns Context with access to SillyTavern internals
   */
  declare export default function getContext(): STContext;

  declare export function getContext(): STContext;
}

declare module "../../../../scripts/events.js" {

  /**
   * All event types that can be emitted by SillyTavern
   */
  declare export var event_types: {
    APP_READY: "app_ready",
    EXTRAS_CONNECTED: "extras_connected",
    MESSAGE_SWIPED: "message_swiped",
    MESSAGE_SENT: "message_sent",
    MESSAGE_RECEIVED: "message_received",
    MESSAGE_EDITED: "message_edited",
    MESSAGE_DELETED: "message_deleted",
    MESSAGE_UPDATED: "message_updated",
    MESSAGE_FILE_EMBEDDED: "message_file_embedded",
    MESSAGE_REASONING_EDITED: "message_reasoning_edited",
    MESSAGE_REASONING_DELETED: "message_reasoning_deleted",
    MESSAGE_SWIPE_DELETED: "message_swipe_deleted",
    MORE_MESSAGES_LOADED: "more_messages_loaded",
    IMPERSONATE_READY: "impersonate_ready",
    CHAT_CHANGED: "chat_id_changed",
    GENERATION_AFTER_COMMANDS: "GENERATION_AFTER_COMMANDS",
    GENERATION_STARTED: "generation_started",
    GENERATION_STOPPED: "generation_stopped",
    GENERATION_ENDED: "generation_ended",
    SD_PROMPT_PROCESSING: "sd_prompt_processing",
    EXTENSIONS_FIRST_LOAD: "extensions_first_load",
    EXTENSION_SETTINGS_LOADED: "extension_settings_loaded",
    SETTINGS_LOADED: "settings_loaded",
    SETTINGS_UPDATED: "settings_updated",
    GROUP_UPDATED: "group_updated",
    MOVABLE_PANELS_RESET: "movable_panels_reset",
    SETTINGS_LOADED_BEFORE: "settings_loaded_before",
    SETTINGS_LOADED_AFTER: "settings_loaded_after",
    CHATCOMPLETION_SOURCE_CHANGED: "chatcompletion_source_changed",
    CHATCOMPLETION_MODEL_CHANGED: "chatcompletion_model_changed",
    OAI_PRESET_CHANGED_BEFORE: "oai_preset_changed_before",
    OAI_PRESET_CHANGED_AFTER: "oai_preset_changed_after",
    OAI_PRESET_EXPORT_READY: "oai_preset_export_ready",
    OAI_PRESET_IMPORT_READY: "oai_preset_import_ready",
    WORLDINFO_SETTINGS_UPDATED: "worldinfo_settings_updated",
    WORLDINFO_UPDATED: "worldinfo_updated",
    CHARACTER_EDITOR_OPENED: "character_editor_opened",
    CHARACTER_EDITED: "character_edited",
    CHARACTER_PAGE_LOADED: "character_page_loaded",
    CHARACTER_GROUP_OVERLAY_STATE_CHANGE_BEFORE: "character_group_overlay_state_change_before",
    CHARACTER_GROUP_OVERLAY_STATE_CHANGE_AFTER: "character_group_overlay_state_change_after",
    USER_MESSAGE_RENDERED: "user_message_rendered",
    CHARACTER_MESSAGE_RENDERED: "character_message_rendered",
    FORCE_SET_BACKGROUND: "force_set_background",
    CHAT_DELETED: "chat_deleted",
    CHAT_CREATED: "chat_created",
    GROUP_CHAT_DELETED: "group_chat_deleted",
    GROUP_CHAT_CREATED: "group_chat_created",
    GENERATE_BEFORE_COMBINE_PROMPTS: "generate_before_combine_prompts",
    GENERATE_AFTER_COMBINE_PROMPTS: "generate_after_combine_prompts",
    GENERATE_AFTER_DATA: "generate_after_data",
    GROUP_MEMBER_DRAFTED: "group_member_drafted",
    GROUP_WRAPPER_STARTED: "group_wrapper_started",
    GROUP_WRAPPER_FINISHED: "group_wrapper_finished",
    WORLD_INFO_ACTIVATED: "world_info_activated",
    TEXT_COMPLETION_SETTINGS_READY: "text_completion_settings_ready",
    CHAT_COMPLETION_SETTINGS_READY: "chat_completion_settings_ready",
    CHAT_COMPLETION_PROMPT_READY: "chat_completion_prompt_ready",
    CHARACTER_FIRST_MESSAGE_SELECTED: "character_first_message_selected",
    CHARACTER_DELETED: "characterDeleted",
    CHARACTER_DUPLICATED: "character_duplicated",
    CHARACTER_RENAMED: "character_renamed",
    CHARACTER_RENAMED_IN_PAST_CHAT: "character_renamed_in_past_chat",
    SMOOTH_STREAM_TOKEN_RECEIVED: "stream_token_received",
    STREAM_TOKEN_RECEIVED: "stream_token_received",
    STREAM_REASONING_DONE: "stream_reasoning_done",
    FILE_ATTACHMENT_DELETED: "file_attachment_deleted",
    WORLDINFO_FORCE_ACTIVATE: "worldinfo_force_activate",
    OPEN_CHARACTER_LIBRARY: "open_character_library",
    ONLINE_STATUS_CHANGED: "online_status_changed",
    IMAGE_SWIPED: "image_swiped",
    CONNECTION_PROFILE_LOADED: "connection_profile_loaded",
    CONNECTION_PROFILE_CREATED: "connection_profile_created",
    CONNECTION_PROFILE_DELETED: "connection_profile_deleted",
    CONNECTION_PROFILE_UPDATED: "connection_profile_updated",
    TOOL_CALLS_PERFORMED: "tool_calls_performed",
    TOOL_CALLS_RENDERED: "tool_calls_rendered",
    CHARACTER_MANAGEMENT_DROPDOWN: "charManagementDropdown",
    SECRET_WRITTEN: "secret_written",
    SECRET_DELETED: "secret_deleted",
    SECRET_ROTATED: "secret_rotated",
    SECRET_EDITED: "secret_edited",
    PRESET_CHANGED: "preset_changed",
    PRESET_DELETED: "preset_deleted",
    PRESET_RENAMED: "preset_renamed",
    PRESET_RENAMED_BEFORE: "preset_renamed_before",
    MAIN_API_CHANGED: "main_api_changed",
    WORLDINFO_ENTRIES_LOADED: "worldinfo_entries_loaded",
    ...
  };

  /**
   * Global event emitter instance
   * Use this to listen for and emit events
   * @example eventSource.on(event_types.MESSAGE_SENT, (data) => { ... });
   */
  declare export var eventSource: any;
}

declare module "../../../../scripts/extensions/regex/index.js" {
  /**
   * Gets available regex scripts
   * @returns Array of regex script objects
   */
  declare export function getRegexScripts(): any[];
}

declare module "../../../../scripts/extensions/regex/engine.js" {
  /**
   * Runs a regex script on text
   * @param scriptName - Name of regex script to run
   * @param text - Text to process
   * @returns Processed text
   */
  declare export function runRegexScript(
    scriptName: any,
    text: string,
    options?: { characterOverride?: any, ... }
  ): string;
}

declare module "../../../extensions.js" {
  /**
   * Gets the SillyTavern context object
   * Re-exported from st-context.js
   * @returns Full SillyTavern context (typed as any in module context)
   */
  declare export function getContext(): any;

  /**
   * Gets the Extras API URL from extension settings
   * @returns API URL string
   */
  declare export function getApiUrl(): string;

  /**
   * Global extension settings object
   * Dynamic structure - properties added by extensions at runtime
   */
  declare export var extension_settings: {
    apiUrl: string,
    apiKey: string,
    autoConnect: boolean,
    notifyUpdates: boolean,
    disabledExtensions: Array<string>,
    expressionOverrides: Array<any>,
    memory: { [key: string]: any, ... },
    note: {
      default: string,
      chara: Array<any>,
      wiAddition: Array<any>,
      ...
    },
    // Most properties are dynamically added by extensions
    [key: string]: any,
    ...
  };
}

declare module "../../../utils.js" {
  /**
   * Hash function for strings
   * @param str - String to hash
   * @param seed - Optional seed value
   * @returns 32-bit integer hash
   */
  declare export function getStringHash(str: string, seed?: number): number;

  /**
   * Creates a debounced function that delays invoking func until after timeout
   * @param func - Function to debounce
   * @param timeout - Timeout in milliseconds
   * @returns Debounced function
   */
  declare export function debounce<F: Function>(
    func: F,
    timeout?: number
  ): (...args: any[]) => void;

  /**
   * Copies text to clipboard
   * @param text - Text to copy
   */
  declare export function copyText(text: string): void;

  /**
   * Trims text to end at a complete sentence
   * @param input - Input text to trim
   * @returns Trimmed text ending at sentence boundary
   */
  declare export function trimToEndSentence(input: string): string;

  /**
   * Triggers browser download of content
   * @param content - Content to download (string or Blob)
   * @param fileName - Name for downloaded file
   * @param contentType - MIME type of content
   */
  declare export function download(
    content: string | any,
    fileName: string,
    contentType: string
  ): void;

  /**
   * Reads a File object and parses as JSON
   * @param file - File to parse
   * @returns Parsed JSON data
   */
  declare export function parseJsonFile(file: any): Promise<any>;

  /**
   * Polls a condition function until it returns true or timeout
   * @param condition - Function that returns boolean
   * @param timeout - Timeout in milliseconds
   * @param interval - Poll interval in milliseconds
   * @param options - Additional options
   * @returns Promise that resolves when condition becomes true
   */
  declare export function waitUntilCondition(
    condition: () => boolean,
    timeout?: number,
    interval?: number,
    options?: Object
  ): Promise<void>;
}

declare module "../../../power-user.js" {
  /**
   * Loads saved positions of moveable UI elements from localStorage
   */
  declare export function loadMovingUIState(): void;

  /**
   * Renders a template string with macros/variables substituted
   * @param params - Parameters to substitute
   * @param options - Optional custom settings
   * @returns Rendered string with substitutions applied
   */
  declare export function renderStoryString(
    params: any,
    options?: {
      customStoryString?: string | null,
      customInstructSettings?: any | null,
      customContextSettings?: any | null,
      ...
    }
  ): string;

  /**
   * Global power user settings object
   * Contains UI preferences and advanced settings
   * Dynamic structure that grows with features
   */
  declare export var power_user: {
    [key: string]: any,
    ...
  };
}

declare module "../../../group-chats.js" {
  /**
   * Boolean flag indicating if group chat is currently generating
   * Similar to is_send_press but for groups
   */
  declare export var is_group_generating: boolean;

  /**
   * Currently selected group ID
   * null if no group selected
   */
  declare export var selected_group: string | null;

  /**
   * ID of currently open group chat
   * null if no group chat open
   */
  declare export var openGroupId: string | null;

  /**
   * Array of all loaded group objects
   * Each object contains group metadata
   */
  declare export var groups: Array<any>;
}

declare module "../../../instruct-mode.js" {
  /**
   * Formats a message for instruct mode
   * @returns Formatted message string
   */
  declare export function formatInstructModeChat(
    name: string,
    mes: string,
    isUser: boolean,
    isNarrator: boolean,
    forceAvatar: any,
    name1: string,
    name2: string,
    forceOutputSequence: any,
    customInstruct?: any | null
  ): string;
}

declare module "../../../preset-manager.js" {
  /**
   * Gets the preset manager for an API
   * @param apiId - API identifier
   * @returns Preset manager instance
   */
  declare export function getPresetManager(apiId?: string): any;
}

declare module "../../../RossAscends-mods.js" {
  /**
   * Makes a jQuery element draggable
   * @param $elmnt - jQuery element to make draggable
   */
  declare export function dragElement($elmnt: any): void;
}

declare module "../../../constants.js" {
  /**
   * Debounce timeout constants
   */
  declare export var debounce_timeout: {
    standard: number,
    relaxed: number,
    extended: number,
    ...
  };
}

declare module "../../../macros.js" {
  /**
   * Macro parser class for handling text substitution
   */
  declare export class MacrosParser {
    constructor(): void;
    static registerMacro(name: string, callback: () => any): void;
    [key: string]: any;
  }
}

declare module "../../../slash-commands/SlashCommandCommonEnumsProvider.js" {
  /**
   * Common enum providers for slash commands
   */
  declare export var commonEnumProviders: {
    [key: string]: any,
    ...
  };
}
