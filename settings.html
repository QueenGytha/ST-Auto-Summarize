<div id="auto_summarize_memory_settings" class="auto_summarize_memory_settings_content">
    <div class="inline-drawer">

        <div class="inline-drawer-toggle inline-drawer-header">
            <div class="flex-container alignitemscenter margin0">
                <b>ST-Auto-Summarize</b>
                <i id="auto_summarize_popout_button" class="fa-solid fa-window-restore menu_button margin0"></i>
            </div>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>

        <div class="inline-drawer-content">

            <!-- transferred to popup -->
            <div class="auto_summarize_memory_settings_content">
                <hr>

                <div class="flex-container justifyspacebetween alignitemscenter">
                    <button id="toggle_chat_memory" class="menu_button flex2" title="Toggle whether memory is enabled for this chat specifically (overrides all settings)."><span>Toggle Memory</span></button>
                    <button id="edit_memory_state" class="menu_button flex2" title="Edit the memories in chat."><span>Edit Memory</span></button>
                    <button id="refresh_memory" class="menu_button fa-solid fa-sync margin0" title="Just refreshes which memories are included and re-renders the memories under each message, doesn't change summaries. This is done automatically all the time, the button is here just in case."></button>
                </div>

                <hr>

                <div class="flex-container alignitemscenter margin0">
                    <h4 class="margin0">Configuration Profiles</h4>
                    <button id="import_profile"     class="menu_button fa-solid fa-file-import"    title="Import a config profile"></button>
                    <button id="export_profile"     class="menu_button fa-solid fa-file-export"    title="Export the current config profile"></button>
                    <input id="import_file" type="file" hidden="" accept=".json">
                </div>
                <div class="flex-container justifyspacebetween alignitemscenter">
                    <select id="profile"            class="flex1 text_pole"                                 title="The currently selected profile"></select>
                    <button id="save_profile"       class="menu_button fa-solid fa-save interactable"       title="Save current profile" tabindex="0"></button>
                    <button id="rename_profile"     class="menu_button fa-solid fa-pencil interactable"     title="Rename current profile" tabindex="0"></button>
                    <button id="new_profile"        class="menu_button fa-solid fa-file-circle-plus interactable" title="Create new profile" tabindex="0"></button>
                    <button id="restore_profile"    class="menu_button fa-solid fa-recycle interactable"    title="Restore current profile" tabindex="0"></button>
                    <button id="delete_profile"     class="menu_button fa-solid fa-trash-can interactable"  title="Delete current profile" tabindex="0"></button>
                </div>
                <div class="flex-container justifyspacebetween alignitemscenter">
                    <button id="character_profile" class="menu_button interactable" title="Auto-load profile for current character" tabindex="0"><i class="fa-solid fa-unlock" style="margin-right: 1em"></i>Character</button>
                    <button id="chat_profile"      class="menu_button interactable" title="Auto-load profile for current chat"      tabindex="0"><i class="fa-solid fa-unlock" style="margin-right: 1em"></i>Chat</button>
                    <label class="checkbox_label" title="Show a notification upon switching profiles">
                        <input id="notify_on_profile_switch" type="checkbox" />
                        <span>Notify on Switch</span>
                    </label>
                </div>


                <!-- Summarization -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Summarization <i class="fa-solid fa-info-circle" title="Customize the prompt used to summarize a given message"></i></h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <div class="flex-container justifyspacebetween alignitemscenter">
                            <button id="edit_summary_prompt" class="menu_button flex1" title="Edit the summary prompt" >Edit Summary Prompt</button>
                            <button id="preview_summary_prompt" class="menu_button fa-solid fa-eye" title="Preview the filled-in summary prompt, using the last message as an example." ></button>
                            <button id="stop_summarization" class="menu_button fa-solid fa-stop" title="Stop all summarization immediately."></button>
                        </div>

                        <table>

                            <tr title="The connection profile to use for summaries. Note that choosing a different profile will require temporarily switching to the profile during summarization, discarding any unsaved changes to the current profile.">
                                <td><span>Connection Profile</span></td>
                                <td><select id="connection_profile" class="text_pole"></select></td>
                            </tr>

                            <tr title="The completion preset to use for summaries. Note that choosing a different preset will require temporarily switching to that preset during summarization, discarding any unsaved changes to the current preset. Also be aware that presets are not shared between connection APIs.">
                                <td><span>Completion Preset</span></td>
                                <td><select id="completion_preset" class="text_pole"></select></td>
                            </tr>

                            <tr title="Start the summarization with this prefilled text.">
                                <td><span>Summary Prefill</span></td>
                                <td><input id="prefill" class="text_pole" type="text" placeholder="Start reply with..."></td>
                            </tr>

                        </table>

                        <label title="Include the prefill in displayed memories and injections (no effect with reasoning models)" class="checkbox_label">
                            <input id="show_prefill" type="checkbox" />
                            <span>Include Prefill In Memories</span>
                        </label>

                        <hr>

                        <label class="checkbox_label" title="New messages will be automatically summarized if they will be included in short-term memory.">
                            <input id="auto_summarize" type="checkbox" />
                            <span>Auto Summarize</span>
                        </label>

                        <label class="checkbox_label" title="Auto-summarization will be triggered before a new message is sent instead of after.">
                            <input id="auto_summarize_on_send" type="checkbox" />
                            <span>Auto Summarize Before Generation</span>
                        </label>

                        <label title="Show the progress bar when auto-summarizing more than 1 message." class="checkbox_label">
                            <input id="auto_summarize_progress" type="checkbox" />
                            <span>Auto Summarize Progress Bar</span>
                        </label>

                        <label class="checkbox_label" title="Number of messages to wait before auto-summarizing a message (0 = summarize up to the most recent message, 1 = wait one message, etc.)">
                            <input id="summarization_delay" class="text_pole widthUnset inline_setting" type="number" min="0" max="999" />
                            <span>Auto Summarize Message Lag</span>
                        </label>

                        <label class="checkbox_label" title="Wait until this many messages before auto-summarizing them all in sequence (1 = summarize every message immediately, 2 = summarize when you have two ready, etc). Still summarizes one at a time. ">
                            <input id="auto_summarize_batch_size" class="text_pole widthUnset inline_setting" type="number" min="1" max="999" />
                            <span>Auto Summarize Batch Size</span>
                        </label>

                        <label class="checkbox_label" title="The maximum amount of lookback when checking for messages to summarize (-1 to disable). For example, 10 means that when auto-summarizing, the 10 most recent valid summarization targets will be checked, and those without summaries will be summarized.">
                            <input id="auto_summarize_message_limit" class="text_pole widthUnset inline_setting" type="number" min="-1" max="999" />
                            <span>Auto Summarize Message Limit</span>
                        </label>

                        <hr>

                        <div class="flex-container justifyspacebetween">
                            <label title="Whether to use messages and/or summaries as context for summarization. You must use {{history}} in the summary prompt. Summaries will follow configured inclusion criteria." class="checkbox_label">
                                <span>Message History </span>
                                <select id="include_message_history_mode" class="text_pole flex2">
                                    <option value="none">None</option>
                                    <option value="messages_only">Messages</option>
                                    <option value="summaries_only">Summaries</option>
                                    <option value="messages_and_summaries">Both</option>
                                </select>
                            </label>
                            <button id="preview_message_history" class="menu_button fa-solid fa-eye interactable" title="Preview what the message history will look like"></button>
                        </div>

                        <label title="How many previous messages to include in the summarization prompt as context.">
                            <input id="include_message_history" class="text_pole widthUnset" type="number" min="1" max="99" />
                            <span>Number of Previous Messages</span>
                        </label>

                        <label title="When including previous messages, also include user messages." class="checkbox_label">
                            <input id="include_user_messages_in_history" type="checkbox" />
                            <span>Include Previous User Messages</span>
                        </label>

                        <hr>

                        <label class="checkbox_label" title="Time in seconds to wait between summarizations. May be needed if you are using a external API with a rate limit.">
                            <input id="summarization_time_delay" class="text_pole widthUnset inline_setting" type="number" min="0" max="999" />
                            <span>Summarization Time Delay</span>
                        </label>

                        <label title="Editing a message will automatically trigger a re-summarization if it has already been summarized." class="checkbox_label">
                            <input id="auto_summarize_on_edit" type="checkbox" />
                            <span>Re-summarize on Edit</span>
                        </label>

                        <label title="Swiping a message will automatically trigger a re-summarization if it has already been summarized." class="checkbox_label">
                            <input id="auto_summarize_on_swipe" type="checkbox" />
                            <span>Re-summarize on Swipe</span>
                        </label>

                        <label title="Block chat input while summarizing." class="checkbox_label">
                            <input id="block_chat" type="checkbox" />
                            <span>Block Chat</span>
                        </label>


                        <label title="The message to summarize will be inside the system instruct template itself. In unchecked (default), the message will instead be added separately after the prompt. Some models benefit from this, but it is not recommended." class="checkbox_label">
                            <input id="nest_messages_in_prompt" type="checkbox" />
                            <span>Nest Message in Summary Prompt</span>
                        </label>

                        <label title="WARNING: doesn't work great. Attempts to preserve context-shifting by including all the content that is sent in regular prompts (world info, description, personas, example messages, message history, etc). If your regular prompts are static, this can allow Context Shifting to work between summarizations, but it decreases the accuracy of summarization due to all the extra stuff in the prompt. It also can't be previewed as this injection is handled by ST, not the extension." class="checkbox_label">
                            <input id="include_world_info" type="checkbox" />
                            <span>Include All Context Content</span>
                        </label>
                    </div>
                </div>


                <!-- General Injection Settings -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">General Injection Settings <i class="fa-solid fa-info-circle" title="Determines how summaries are injected into context."></i></h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <label title="Separator between summaries when injected into context." class="checkbox_label">
                            <input id="summary_injection_separator" class="text_pole" type="text" placeholder="" style="width: 5em">
                            <span>Summary Injection Separator</span>
                        </label>
                        <label title="The number of messages to wait before summaries start to be injected." class="checkbox_label">
                            <input id="summary_injection_threshold" class="text_pole widthUnset" type="number" min="0" max="999" />
                            <span>Start Injecting After</span>
                        </label>
                        <label title="Messages after the summary injection threshold above will be removed from context, leaving only the summaries." class="checkbox_label">
                            <input id="exclude_messages_after_threshold" type="checkbox">
                            <span>Remove Messages After Threshold</span>
                        </label>
                        <label title="This will keep the most recent user message in context even if it's past the exclusion threshold" class="checkbox_label">
                            <input id="keep_last_user_message" type="checkbox">
                            <span>Preserve Last User Message</span>
                        </label>
                        <div class="flex-container justifyspacebetween alignitemscenter">
                            <button id="edit_scene_injection_template" class="menu_button flex1" title="Edit the scene summary injection template">Edit Scene Injection Template</button>
                            <input id="scene_summary_template" type="hidden" />
                        </div>
                    </div>
                </div>


                <!-- Message Summaries -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Message Summaries <i class="fa-solid fa-info-circle" title="Controls which messages are summarized and stored in memory."></i></h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <div class="flex-container justifyspacebetween alignitemscenter">
                            <button id="edit_message_summary_memory_prompt" class="menu_button flex1" title="Edit the message summary prompt"><span>Edit Message Summary Prompt</span></button>
                        </div>

                        <label title="Auto-summarize user messages and include summaries in memory." class="checkbox_label">
                            <input id="include_user_messages" type="checkbox" />
                            <span>Include User Messages</span>
                        </label>

                        <label title="Auto-summarize hidden messages and include summaries in memory (messages excluded from context)." class="checkbox_label">
                            <input id="include_system_messages" type="checkbox" />
                            <span>Include Hidden Messages</span>
                        </label>

                        <label title="Auto-summarize system messages and include summaries in memory (e.g. messages from the /sys command)." class="checkbox_label">
                            <input id="include_narrator_messages" type="checkbox" />
                            <span>Include System Messages</span>
                        </label>

                        <label title="The minimum token length a message has to be in order to get summarized.">
                            <input id="message_length_threshold" class="text_pole widthUnset inline_setting" type="number" min="0" max="999" />
                            <span>Message Length Threshold</span>
                        </label>

                        <br>

                        <div class="flex-container justifyspacebetween">
                            <label title="The max amount of context that message summaries can take up (percent or number of tokens).">
                                <input id="message_summary_context_limit" class="text_pole widthUnset inline_setting" type="number" min="0" max="99999" />
                                <span>Context Limit (<span id="message_summary_context_limit_display"></span> tk)</span>
                            </label>
                            <div>
                                <label>
                                    <input type="radio" name="message_summary_context_type" value="percent" />
                                    <span>%</span>
                                </label>
                                <label>
                                    <input type="radio" name="message_summary_context_type" value="tokens" />
                                    <span>tk</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Scene Summary -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Scene Summary <i class="fa-solid fa-info-circle" title="Summarize each scene break as a single summary, with customizable prompt and injection."></i></h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <label class="checkbox_label" title="Show or hide the scene summary navigator bar on the left.">
                            <input id="scene_summary_navigator_toggle" type="checkbox" />
                            <span>Show Scene Navigator Bar</span>
                        </label>
                        <label title="Width of the scene navigator bar in pixels.">
                            <span>Navigator Bar Width (pixels):</span>
                            <input id="scene_summary_navigator_width" class="text_pole" type="number" min="30" max="300" step="1" />
                        </label>
                        <label title="Font size for scene names in the navigator bar (in pixels).">
                            <span>Navigator Font Size (pixels):</span>
                            <input id="scene_summary_navigator_font_size" class="text_pole" type="number" min="8" max="24" step="1" />
                        </label>
                        <label class="checkbox_label" title="Enable scene-level summarization and injection.">
                            <input id="scene_summary_enabled" type="checkbox" />
                            <span>Enable Scene Summaries</span>
                        </label>
                        <label class="checkbox_label" title="Automatically generate a brief scene name (like a chapter title) when auto-generating scene summaries (e.g., during scene break detection), if no name is already set.">
                            <input id="scene_summary_auto_name" type="checkbox" />
                            <span>Auto-generate Scene Names (Auto-Detection)</span>
                        </label>
                        <label class="checkbox_label" title="Automatically generate a brief scene name (like a chapter title) when manually generating scene summaries via the Generate button, if no name is already set.">
                            <input id="scene_summary_auto_name_manual" type="checkbox" />
                            <span>Auto-generate Scene Names (Manual)</span>
                        </label>
                        <label class="checkbox_label" title="New scene summaries will start collapsed by default (showing only the scene name). Existing scenes keep their current state.">
                            <input id="scene_summary_default_collapsed" type="checkbox" />
                            <span>Collapse New Scenes by Default</span>
                        </label>
                        <div class="flex-container justifyspacebetween alignitemscenter">
                            <button id="edit_scene_summary_prompt" class="menu_button flex1" title="Edit the scene summary prompt"><span>Edit Scene Prompt</span></button>
                        </div>
                        <input id="scene_summary_prompt" type="hidden" />
                        <input id="scene_summary_default_prompt" type="hidden" value="[Default scene summary prompt here]" />
                        <table>
                            <tr>
                                <td><span>Scene Completion Preset</span></td>
                                <td><select id="scene_summary_completion_preset" class="text_pole"></select></td>
                            </tr>
                            <tr>
                                <td><span>Scene Summary Prefill</span></td>
                                <td><input id="scene_summary_prefill" class="text_pole" type="text" placeholder="Start reply with..."></td>
                            </tr>
                            <tr>
                                <td><span>Scene Message History Mode</span></td>
                                <td>
                                    <select id="scene_summary_history_mode" class="text_pole">
                                        <option value="messages">Messages Only</option>
                                        <option value="summaries">Summaries Only</option>
                                        <option value="both">Messages and Summaries</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td><span>Include Message Types</span></td>
                                <td>
                                    <select id="scene_summary_message_types" class="text_pole">
                                        <option value="user">User Messages Only</option>
                                        <option value="character">AI Messages Only</option>
                                        <option value="both">All Messages</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span>Summarize the last <span id="scene_summary_history_count_display">1</span> scenes</span>
                                </td>
                                <td>
                                    <input id="scene_summary_history_count" class="text_pole" type="number" min="1" max="99" value="1" />
                                </td>
                            </tr>
                        </table>
                        <label title="Where to inject the scene summary.">
                            <select id="scene_summary_position" class="text_pole">
                                <option value="-1">Do not inject</option>
                                <option value="2">Before main prompt</option>
                                <option value="0">After main prompt</option>
                                <option value="1">In chat at depth</option>
                            </select>
                        </label>
                        <label title="Depth for in-chat injection.">
                            <input id="scene_summary_depth" class="text_pole inline_setting" type="number" min="0" max="99" />
                            <span>Depth</span>
                        </label>
                        <label title="Role for in-chat injection.">
                            <select id="scene_summary_role" class="text_pole inline_setting">
                                <option value="0">System</option>
                                <option value="1">User</option>
                                <option value="2">Assistant</option>
                            </select>
                        </label>
                        <label class="checkbox_label" title="Include in World Info Scanning">
                            <input id="scene_summary_scan" type="checkbox" />
                            <span>Include in World Info Scanning</span>
                        </label>
                        <label title="Context limit for scene summary.">
                            <input id="scene_summary_context_limit" class="text_pole widthUnset inline_setting" type="number" min="0" max="99999" />
                            <span>Context Limit</span>
                        </label>
                        <label>
                            <input type="radio" name="scene_summary_context_type" value="percent" />
                            <span>%</span>
                        </label>
                        <label>
                            <input type="radio" name="scene_summary_context_type" value="tokens" />
                            <span>tk</span>
                        </label>
                    </div>
                </div>

                <!-- Running Scene Summary -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Running Scene Summary <i class="fa-solid fa-info-circle" title="Combine multiple scene summaries into a single cohesive memory. This is the recommended default behavior matching best practices."></i></h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <label class="checkbox_label" title="Enable running scene summary - combines all scene summaries into one cohesive narrative memory (recommended default).">
                            <input id="running_scene_summary_enabled" type="checkbox" />
                            <span>Enable Running Scene Summary (Recommended)</span>
                        </label>
                        <label title="Number of latest scene summaries to exclude from the running summary. Default: 1 (allows you to validate the latest scene summary before it's combined).">
                            <span>Exclude Latest <span id="running_scene_summary_exclude_latest_display">1</span> Scene(s)</span>
                            <input id="running_scene_summary_exclude_latest" class="text_pole" type="range" min="0" max="5" step="1" value="1" />
                        </label>
                        <small style="display:block; margin-bottom:0.5em;">Recommended: 1 (exclude latest scene to allow manual validation before combining)</small>

                        <label class="checkbox_label" title="Automatically generate running scene summary when new scene summaries are created.">
                            <input id="running_scene_summary_auto_generate" type="checkbox" />
                            <span>Auto-generate on New Scene Summaries</span>
                        </label>

                        <label class="checkbox_label" title="Show version control buttons in the navbar to switch between, edit, or delete running summary versions.">
                            <input id="running_scene_summary_show_navbar" type="checkbox" />
                            <span>Show Navbar Version Controls</span>
                        </label>

                        <div class="flex-container justifyspacebetween alignitemscenter">
                            <button id="view_running_scene_summary" class="menu_button flex2" title="View/edit the current running scene summary"><span>View Running Summary</span></button>
                            <button id="edit_running_scene_summary_prompt" class="menu_button flex1" title="Edit the running scene summary prompt"><span>Edit Running Summary Prompt</span></button>
                        </div>
                        <input id="running_scene_summary_prompt" type="hidden" />

                        <table>
                            <tr>
                                <td><span>Running Summary Completion Preset</span></td>
                                <td><select id="running_scene_summary_completion_preset" class="text_pole"></select></td>
                            </tr>
                            <tr>
                                <td><span>Running Summary Connection Profile</span></td>
                                <td><select id="running_scene_summary_connection_profile" class="text_pole"></select></td>
                            </tr>
                            <tr>
                                <td><span>Running Summary Prefill</span></td>
                                <td><input id="running_scene_summary_prefill" class="text_pole" type="text" placeholder="Start reply with..."></td>
                            </tr>
                        </table>

                        <label title="Where to inject the running scene summary.">
                            <select id="running_scene_summary_position" class="text_pole">
                                <option value="-1">Do not inject</option>
                                <option value="2">Before main prompt</option>
                                <option value="0">After main prompt</option>
                                <option value="1">In chat at depth</option>
                            </select>
                        </label>
                        <label title="Depth for in-chat injection.">
                            <input id="running_scene_summary_depth" class="text_pole inline_setting" type="number" min="0" max="99" />
                            <span>Depth</span>
                        </label>
                        <label title="Role for in-chat injection.">
                            <select id="running_scene_summary_role" class="text_pole inline_setting">
                                <option value="0">System</option>
                                <option value="1">User</option>
                                <option value="2">Assistant</option>
                            </select>
                        </label>
                        <label class="checkbox_label" title="Include in World Info Scanning">
                            <input id="running_scene_summary_scan" type="checkbox" />
                            <span>Include in World Info Scanning</span>
                        </label>
                        <label title="Context limit for running scene summary.">
                            <input id="running_scene_summary_context_limit" class="text_pole widthUnset inline_setting" type="number" min="0" max="99999" />
                            <span>Context Limit</span>
                        </label>
                        <label>
                            <input type="radio" name="running_scene_summary_context_type" value="percent" />
                            <span>%</span>
                        </label>
                        <label>
                            <input type="radio" name="running_scene_summary_context_type" value="tokens" />
                            <span>tk</span>
                        </label>
                    </div>
                </div>

                <!-- Auto Scene Break Detection -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Auto Scene Break Detection <i class="fa-solid fa-info-circle" title="Automatically detect and mark scene breaks using AI analysis."></i></h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <label class="checkbox_label" title="Enable automatic scene break detection using LLM.">
                            <input id="auto_scene_break_enabled" type="checkbox" />
                            <span>Enable Auto Scene Break Detection</span>
                        </label>
                        <label class="checkbox_label" title="Automatically check for scene breaks when chat loads.">
                            <input id="auto_scene_break_on_load" type="checkbox" />
                            <span>Auto-check on Chat Load</span>
                        </label>
                        <label class="checkbox_label" title="Automatically check for scene breaks when new messages arrive.">
                            <input id="auto_scene_break_on_new_message" type="checkbox" />
                            <span>Auto-check on New Messages</span>
                        </label>
                        <label class="checkbox_label" title="Automatically generate a scene summary when a scene break is detected. The summary generation will complete before checking the next message.">
                            <input id="auto_scene_break_generate_summary" type="checkbox" />
                            <span>Auto-generate Scene Summary on Detection</span>
                        </label>

                        <label title="How many messages back from the latest to skip checking. 0 = check all including latest, 1 = skip latest, 2 = skip 2 latest, etc.">
                            <span>Message Offset (skip latest N messages): <span id="auto_scene_break_message_offset_value">1</span></span>
                            <input id="auto_scene_break_message_offset" class="text_pole" type="range" min="0" max="10" step="1" value="1" />
                        </label>
                        <small style="display:block; margin-bottom:0.5em;">Recommended: 1 (skip latest message since you may not like it yet)</small>

                        <label title="Which message types to check for scene breaks.">
                            <span>Check Which Messages:</span>
                            <select id="auto_scene_break_check_which_messages" class="text_pole">
                                <option value="character">AI Messages Only</option>
                                <option value="user">User Messages Only</option>
                                <option value="both">Both User and AI Messages</option>
                            </select>
                        </label>
                        <small style="display:block; margin-bottom:0.5em;">Scene breaks typically occur in AI responses, but some users write them in their inputs too.</small>

                        <div class="flex-container justifyspacebetween alignitemscenter">
                            <button id="edit_auto_scene_break_prompt" class="menu_button flex1" title="Edit the auto scene break detection prompt"><span>Edit Detection Prompt</span></button>
                        </div>

                        <input id="auto_scene_break_prompt" type="hidden" />

                        <table>
                            <tr title="The connection profile to use for scene break detection. Leave empty to use current profile.">
                                <td><span>Detection Connection Profile</span></td>
                                <td><select id="auto_scene_break_connection_profile" class="text_pole"></select></td>
                            </tr>
                            <tr title="The completion preset to use for scene break detection. Leave empty to use current preset.">
                                <td><span>Detection Completion Preset</span></td>
                                <td><select id="auto_scene_break_completion_preset" class="text_pole"></select></td>
                            </tr>
                            <tr title="Start the detection with this prefilled text to enforce true/false output.">
                                <td><span>Detection Prefill</span></td>
                                <td><input id="auto_scene_break_prefill" class="text_pole" type="text" placeholder=""></td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Error Detection -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Summary Validation <i class="fa-solid fa-info-circle" title="Configure validation for summaries to ensure they meet your criteria"></i></h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <label class="checkbox_label" title="Enable two-step validation for summaries">
                            <input id="error_detection_enabled" type="checkbox" />
                            <span>Enable Summary Validation</span>
                        </label>

                        <!-- Regular summary validation -->
                <label class="checkbox_label error_detection_setting" title="Enable validation for regular message summaries">
                    <input id="message_summary_error_detection_enabled" type="checkbox" />
                    <span>Validate Regular Summaries</span>
                </label>
                <div class="flex-container justifyspacebetween alignitemscenter">
                    <button id="edit_message_summary_error_detection_prompt" class="menu_button flex1 error_detection_setting" title="Edit the validation prompt for regular message summaries"><span>Edit Message Summary Validation Prompt</span></button>
                </div>

                <table class="regular_error_detection_container">
                    <tr>
                        <td><span>Message Summary Validation Preset</span></td>
                        <td><select id="message_summary_error_detection_preset" class="text_pole regular_error_detection_setting"></select></td>
                    </tr>
                    <tr>
                        <td><span>Message Summary Validation Prefill</span></td>
                        <td><input id="message_summary_error_detection_prefill" class="text_pole regular_error_detection_setting" type="text" placeholder="Start reply with..."></td>
                    </tr>
                    <tr>
                        <td><span>Message Summary Max Retry Attempts</span></td>
                        <td><input id="message_summary_error_detection_retries" class="text_pole regular_error_detection_setting" type="number" min="1" max="10" value="3"></td>
                    </tr>
                </table>

                <!-- Scene summary validation -->
                <label class="checkbox_label error_detection_setting" title="Enable validation for scene summaries">
                    <input id="scene_summary_error_detection_enabled" type="checkbox" />
                    <span>Validate Scene Summaries</span>
                </label>
                <div class="flex-container justifyspacebetween alignitemscenter">
                    <button id="edit_scene_summary_error_detection_prompt" class="menu_button flex1 error_detection_setting" title="Edit the validation prompt for scene summaries"><span>Edit Scene Summary Validation Prompt</span></button>
                </div>
                <table class="scene_error_detection_container">
                    <tr>
                        <td><span>Scene Summary Validation Preset</span></td>
                        <td><select id="scene_summary_error_detection_preset" class="text_pole scene_error_detection_setting"></select></td>
                    </tr>
                    <tr>
                        <td><span>Scene Summary Validation Prefill</span></td>
                        <td><input id="scene_summary_error_detection_prefill" class="text_pole scene_error_detection_setting" type="text" placeholder="Start reply with..."></td>
                    </tr>
                    <tr>
                        <td><span>Scene Summary Max Retry Attempts</span></td>
                        <td><input id="scene_summary_error_detection_retries" class="text_pole scene_error_detection_setting" type="number" min="1" max="10" value="3"></td>
                    </tr>
                </table>
                <input id="scene_summary_error_detection_prompt" type="hidden" />

                        <!-- Store the prompts in hidden inputs since they're edited via the edit dialog -->
                        <input id="message_summary_error_detection_prompt" type="hidden" />
                    </div>
                </div>

                <!-- Auto-Hide -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Auto-Hide</h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <label title="Automatically hide (exclude from prompts) messages older than this many messages (set -1 to disable)" class="checkbox_label">
                            <span>Auto Hide Messages Older Than The Last</span>
                            <input id="auto_hide_message_age" class="text_pole widthUnset inline_setting" type="number" min="-1" max="9999" />
                            <span>Message(s) (-1 to disable)</span>
                        </label>
                        <label title="Automatically hide all messages in scenes older than this many scenes (set -1 to disable)" class="checkbox_label">
                            <span>Auto Hide Messages Older Than The Last</span>
                            <input id="auto_hide_scene_count" class="text_pole widthUnset inline_setting" type="number" min="-1" max="999" />
                            <span>Scene(s) (-1 to disable)</span>
                        </label>
                    </div>
                </div>

                <!-- Misc. -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Misc.</h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <label title="Fill your console with debug messages" class="checkbox_label">
                            <input id="debug_mode" type="checkbox" />
                            <span>Debug Mode</span>
                        </label>

                        <label title="Display summarizations below each message" class="checkbox_label">
                            <input id="display_memories" type="checkbox" />
                            <span>Display Memories</span>
                        </label>

                        <label title="Whether memory is enabled by default for new chats." class="checkbox_label">
                            <input id="default_chat_enabled" type="checkbox" />
                            <span>Enable Memory in New Chats</span>
                        </label>

                        <label title="Uses a global on/off state shared between all chats with this enabled. When unchecked, turning the extension on/off only applies to active chat." class="checkbox_label">
                            <input id="use_global_toggle_state" type="checkbox" />
                            <span>Use Global Toggle State</span>
                        </label>
                    </div>
                </div>

                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Operation Queue</h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <label title="Enable persistent operation queue for summarization tasks. Operations survive SillyTavern restarts and are processed sequentially." class="checkbox_label">
                            <input id="operation_queue_enabled" type="checkbox" />
                            <span>Enable Operation Queue</span>
                        </label>

                        <label title="Store queue in a visible lorebook entry (__operation_queue). When disabled, queue is stored in hidden chat metadata instead." class="checkbox_label">
                            <input id="operation_queue_use_lorebook" type="checkbox" />
                            <span>Use Lorebook for Queue Storage</span>
                        </label>

                        <label title="Display the operation queue UI in the navbar showing pending/running/completed operations." class="checkbox_label">
                            <input id="operation_queue_display_enabled" type="checkbox" />
                            <span>Show Queue UI in Navbar</span>
                        </label>
                    </div>
                </div>

                <!-- Auto-Lorebooks Settings -->
                <hr>
                <div class="inline-drawer">
                    <div class="inline-drawer-toggle inline-drawer-header">
                        <div class="flex-container alignitemscenter margin0">
                            <h4 class="margin0">Auto-Lorebooks</h4>
                        </div>
                        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                    </div>
                    <div class="inline-drawer-content">
                        <h4>Current Chat</h4>
                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-chat-enabled">
                                <input type="checkbox" id="autolorebooks-chat-enabled" />
                                <span>Enable Auto-Lorebook for this chat</span>
                            </label>
                            <div class="margin-top-10px">
                                <small>Current lorebook: <strong><span id="autolorebooks-current-lorebook">None</span></strong></small>
                            </div>
                        </div>

                        <hr>

                        <h4>Global Settings</h4>

                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-enabled-by-default">
                                <input type="checkbox" id="autolorebooks-enabled-by-default" />
                                <span>Enable by default for new chats</span>
                            </label>
                        </div>

                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-delete-on-chat-delete">
                                <input type="checkbox" id="autolorebooks-delete-on-chat-delete" />
                                <span>Delete lorebook when chat is deleted</span>
                            </label>
                        </div>

                        <div class="margin-bot-10px">
                            <label for="autolorebooks-name-template">
                                <span>Lorebook naming template:</span>
                                <small class="displayBlock opacity50p">Available variables: {{char}}, {{chat}}</small>
                            </label>
                            <input type="text" id="autolorebooks-name-template" class="text_pole" placeholder="z-AutoLB - {{char}} - {{chat}}" />
                        </div>

                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-debug-mode">
                                <input type="checkbox" id="autolorebooks-debug-mode" />
                                <span>Debug mode (verbose console logging)</span>
                            </label>
                        </div>

                        <div class="margin-bot-10px">
                            <label>
                                <span>Supported lorebook entry types:</span>
                                <small class="displayBlock opacity50p">Applies to the {{lorebook_entry_types}} macro and registry generation. Values should be lowercase slugs.</small>
                            </label>
                            <div id="autolorebooks-entity-types-list" class="margin-top-5px"></div>
                            <div class="flex-container alignitemscenter margin-top-5px" style="gap: 5px;">
                                <input type="text" id="autolorebooks-entity-type-input" class="text_pole" placeholder="e.g. quest(entry:constant)" />
                                <button id="autolorebooks-add-entity-type" class="menu_button">Add</button>
                                <button id="autolorebooks-restore-entity-types" class="menu_button fa-solid fa-recycle" title="Restore default types"></button>
                            </div>
                        </div>

                        <hr>

                        <h4>AI-Editable Tracking Entries</h4>
                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-tracking-enabled">
                                <input type="checkbox" id="autolorebooks-tracking-enabled" />
                                <span>Enable tracking entries (GM Notes, Character Stats)</span>
                            </label>
                            <div class="margin-top-5px">
                                <small class="opacity50p">AI can update special lorebook entries via syntax in messages</small>
                            </div>
                        </div>

                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-tracking-intercept-send">
                                <input type="checkbox" id="autolorebooks-tracking-intercept-send" />
                                <span>Process latest AI message before sending (Recommended)</span>
                            </label>
                            <div class="margin-top-5px">
                                <small class="opacity50p">Intercepts send button to update lorebooks with latest AI response before generating. Ensures character stats and GM notes are current.</small>
                            </div>
                        </div>

                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-tracking-auto-create">
                                <input type="checkbox" id="autolorebooks-tracking-auto-create" />
                                <span>Auto-create tracking entries when chat loads</span>
                            </label>
                        </div>

                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-tracking-remove-syntax">
                                <input type="checkbox" id="autolorebooks-tracking-remove-syntax" />
                                <span>Remove tracking syntax from AI messages</span>
                            </label>
                            <div class="margin-top-5px">
                                <small class="opacity50p">Hides update commands from user when editing messages</small>
                            </div>
                        </div>

                        <div class="inline-drawer margin-top-10px">
                            <div class="inline-drawer-toggle inline-drawer-header">
                                <div class="flex-container alignitemscenter margin0">
                                    <span>Syntax Patterns</span>
                                </div>
                                <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                            </div>
                            <div class="inline-drawer-content">
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-tracking-syntax-gm-notes">
                                        <span>GM Notes syntax:</span>
                                        <small class="displayBlock opacity50p">Use {{content}} as placeholder</small>
                                    </label>
                                    <input type="text" id="autolorebooks-tracking-syntax-gm-notes" class="text_pole" placeholder="<-- gm_notes: {{content}} -->" />
                                </div>

                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-tracking-syntax-character-stats">
                                        <span>Character Stats syntax:</span>
                                        <small class="displayBlock opacity50p">Use {{content}} as placeholder</small>
                                    </label>
                                    <input type="text" id="autolorebooks-tracking-syntax-character-stats" class="text_pole" placeholder="<-- character_stats: {{content}} -->" />
                                </div>
                            </div>
                        </div>

                        <div class="inline-drawer margin-top-10px">
                            <div class="inline-drawer-toggle inline-drawer-header">
                                <div class="flex-container alignitemscenter margin0">
                                    <span>AI Merge Settings</span>
                                </div>
                                <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                            </div>
                            <div class="inline-drawer-content">
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-tracking-merge-connection">
                                        <span>Connection Profile:</span>
                                        <small class="displayBlock opacity50p">Which API to use for merging updates (empty = use main API)</small>
                                    </label>
                                    <select id="autolorebooks-tracking-merge-connection" class="text_pole">
                                        <option value="">Main API</option>
                                    </select>
                                </div>

                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-tracking-merge-preset">
                                        <span>Completion Preset:</span>
                                        <small class="displayBlock opacity50p">Preset to use for merging (empty = use default)</small>
                                    </label>
                                    <select id="autolorebooks-tracking-merge-preset" class="text_pole">
                                        <option value="">Default</option>
                                    </select>
                                </div>

                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-tracking-merge-prefill">
                                        <span>Prefill (Claude models):</span>
                                        <small class="displayBlock opacity50p">Text to prefill AI response</small>
                                    </label>
                                    <input type="text" id="autolorebooks-tracking-merge-prefill" class="text_pole" placeholder="" />
                                </div>

                                <div class="margin-bot-10px">
                                    <div class="flex-container alignitemscenter justifyspacebetween margin-bot-5px">
                                        <label for="autolorebooks-tracking-merge-prompt-gm-notes">
                                            <span>GM Notes merge prompt:</span>
                                            <small class="displayBlock opacity50p">Use {{current_content}} and {{new_update}}</small>
                                        </label>
                                        <button id="restore-gm-notes-merge-prompt" class="menu_button fa-solid fa-recycle" title="Restore default GM Notes merge prompt"></button>
                                    </div>
                                    <textarea id="autolorebooks-tracking-merge-prompt-gm-notes" class="text_pole textarea_compact" rows="8" placeholder="Prompt for merging GM notes..."></textarea>
                                </div>

                                <div class="margin-bot-10px">
                                    <div class="flex-container alignitemscenter justifyspacebetween margin-bot-5px">
                                        <label for="autolorebooks-tracking-merge-prompt-character-stats">
                                            <span>Character Stats merge prompt:</span>
                                            <small class="displayBlock opacity50p">Use {{current_content}} and {{new_update}}</small>
                                        </label>
                                        <button id="restore-character-stats-merge-prompt" class="menu_button fa-solid fa-recycle" title="Restore default Character Stats merge prompt"></button>
                                    </div>
                                    <textarea id="autolorebooks-tracking-merge-prompt-character-stats" class="text_pole textarea_compact" rows="8" placeholder="Prompt for merging character stats..."></textarea>
                                </div>
                            </div>
                        </div>

                        <hr>

                        <h4>Summary-to-Lorebook Processing</h4>

                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-summary-processing-enabled">
                                <input type="checkbox" id="autolorebooks-summary-processing-enabled" />
                                <span>Enable summary-to-lorebook processing</span>
                            </label>
                            <div class="margin-top-5px">
                                <small class="opacity50p">Process summary JSON objects to extract and create/update lorebook entries</small>
                            </div>
                        </div>

                        <div class="margin-bot-10px">
                            <label class="checkbox_label" for="autolorebooks-summary-skip-duplicates">
                                <input type="checkbox" id="autolorebooks-summary-skip-duplicates" />
                                <span>Skip already processed summaries</span>
                            </label>
                        </div>

                        <div class="inline-drawer margin-top-10px">
                            <div class="inline-drawer-toggle inline-drawer-header">
                                <div class="flex-container alignitemscenter margin0">
                                    <span>Entry Merge Settings (When Processing Summaries)</span>
                                </div>
                                <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                            </div>
                            <div class="inline-drawer-content">
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-merge-connection">
                                        <span>Connection Profile:</span>
                                        <small class="displayBlock opacity50p">Which API to use for merging lorebook entries (empty = use main API)</small>
                                    </label>
                                    <select id="autolorebooks-summary-merge-connection" class="text_pole">
                                        <option value="">Main API</option>
                                    </select>
                                </div>

                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-merge-preset">
                                        <span>Completion Preset:</span>
                                        <small class="displayBlock opacity50p">Preset to use for merging entries (empty = use default)</small>
                                    </label>
                                    <select id="autolorebooks-summary-merge-preset" class="text_pole">
                                        <option value="">Default</option>
                                    </select>
                                </div>

                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-merge-prefill">
                                        <span>Prefill (Claude models):</span>
                                        <small class="displayBlock opacity50p">Text to prefill AI response</small>
                                    </label>
                                    <input type="text" id="autolorebooks-summary-merge-prefill" class="text_pole" placeholder="" />
                                </div>

                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-merge-prompt">
                                        <span>Lorebook entry merge prompt:</span>
                                        <small class="displayBlock opacity50p">Use {{existing_content}} and {{new_content}}. Merges new summary data with existing entry content.</small>
                                    </label>
                                    <textarea id="autolorebooks-summary-merge-prompt" class="text_pole textarea_compact" rows="10"></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="inline-drawer margin-top-10px">
                            <div class="inline-drawer-toggle inline-drawer-header">
                                <div class="flex-container alignitemscenter margin0">
                                    <span>Duplicate Detection Settings</span>
                                </div>
                                <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                            </div>
                            <div class="inline-drawer-content">
                                <h5 class="margin-top-0">Stage 1  Registry Triage</h5>
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-triage-connection">
                                        <span>Connection Profile:</span>
                                        <small class="displayBlock opacity50p">API profile to use when screening new entries (empty = use main API)</small>
                                    </label>
                                    <select id="autolorebooks-summary-triage-connection" class="text_pole">
                                        <option value="">Main API</option>
                                    </select>
                                </div>
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-triage-preset">
                                        <span>Completion Preset:</span>
                                        <small class="displayBlock opacity50p">Preset for triage calls (empty = use default)</small>
                                    </label>
                                    <select id="autolorebooks-summary-triage-preset" class="text_pole">
                                        <option value="">Default</option>
                                    </select>
                                </div>
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-triage-prefill">
                                        <span>Prefill (Claude models):</span>
                                        <small class="displayBlock opacity50p">Optional text to prefill AI responses during triage</small>
                                    </label>
                                    <input type="text" id="autolorebooks-summary-triage-prefill" class="text_pole" placeholder="" />
                                </div>
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-triage-prompt" class="flex-container alignitemscenter justifyspacebetween">
                                        <span>Triage prompt:</span>
                                        <button id="restore-summary-triage-prompt" class="menu_button fa-solid fa-recycle" title="Restore default triage prompt"></button>
                                    </label>
                                    <small class="displayBlock opacity50p">Use macros: {{lorebook_entry_types}}, {{new_entry}}, {{candidate_registry}}</small>
                                    <textarea id="autolorebooks-summary-triage-prompt" class="text_pole textarea_compact" rows="10"></textarea>
                                </div>

                                <h5>Stage 2  Full Resolution</h5>
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-resolution-connection">
                                        <span>Connection Profile:</span>
                                        <small class="displayBlock opacity50p">API profile when comparing full entries (empty = use main API)</small>
                                    </label>
                                    <select id="autolorebooks-summary-resolution-connection" class="text_pole">
                                        <option value="">Main API</option>
                                    </select>
                                </div>
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-resolution-preset">
                                        <span>Completion Preset:</span>
                                        <small class="displayBlock opacity50p">Preset for the follow-up comparison call (empty = use default)</small>
                                    </label>
                                    <select id="autolorebooks-summary-resolution-preset" class="text_pole">
                                        <option value="">Default</option>
                                    </select>
                                </div>
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-resolution-prefill">
                                        <span>Prefill (Claude models):</span>
                                        <small class="displayBlock opacity50p">Optional text to prefill the comparison response</small>
                                    </label>
                                    <input type="text" id="autolorebooks-summary-resolution-prefill" class="text_pole" placeholder="" />
                                </div>
                                <div class="margin-bot-10px">
                                    <label for="autolorebooks-summary-resolution-prompt" class="flex-container alignitemscenter justifyspacebetween">
                                        <span>Resolution prompt:</span>
                                        <button id="restore-summary-resolution-prompt" class="menu_button fa-solid fa-recycle" title="Restore default resolution prompt"></button>
                                    </label>
                                    <small class="displayBlock opacity50p">Use macros: {{lorebook_entry_types}}, {{new_entry}}, {{triage_synopsis}}, {{candidate_entries}}</small>
                                    <textarea id="autolorebooks-summary-resolution-prompt" class="text_pole textarea_compact" rows="10"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <hr>
                <div class="flex-container justifyspacebetween alignitemscenter">
                    <button id="revert_settings" class="menu_button flex1 margin0" title="Restore all settings to their default values. This completely resets all configuration options to factory defaults. Your saved profiles won't be affected.">
                        <span>Restore All Defaults</span>
                    </button>
                </div>

            </div>
        </div>
    </div>
</div>
